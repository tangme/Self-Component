function Ttag(t){var e=t.el;this.opt=t,this.pattern="&,&",this.editarea=document.querySelector(e),this.selectArea=this.editarea.querySelector(".t-tag-select-item-con"),this.inputForm=this.selectArea.querySelector("input"),this.tag={_show:!1},this.hideSelTag=this.hideSelTag.bind(this),this.init(),t.value&&this.setData(t.value)}Ttag.prototype.setData=function(t){var e,a=t.split(",");for(e in a)this.addTag(a[e])},Ttag.prototype.init=function(){var a=this;Object.defineProperties(this.tag,{show:{get:function(){return this._show},set:function(t){var e=a.selectArea.getAttribute("class");t?(e=e.replace("close-ttag",""),document.addEventListener("click",a.hideSelTag)):(e=e.concat("close-ttag"),document.removeEventListener("click",a.hideSelTag)),a.selectArea.setAttribute("class",e),this._show=t}}}),this.editarea.addEventListener("click",function(t){if(t.stopPropagation(),t.preventDefault(),"edit-item-del"===t.target.getAttribute("class")){var e=t.target.parentNode.querySelector(".edit-item-text").innerHTML;return a.inputForm.value=a.inputForm.value.replace(e+a.pattern,""),void t.target.parentNode.parentNode.removeChild(t.target.parentNode)}a.tag.show||(a.tag.show=!0),"t-tag-con"===t.target.getAttribute("class")&&a.newTag()}),this.selectArea.addEventListener("click",function(t){t.stopPropagation(),"t-tag-item"===t.target.getAttribute("class")&&a.addTag(t.target.innerHTML)}),this.loadData()},Ttag.prototype.loadData=function(){var a,i=this;this.opt.data&&(a=document.createDocumentFragment(),this.opt.data.forEach(function(t){i.pattern;var e=document.createElement("span");e.setAttribute("class","t-tag-item"),e.innerHTML=t,a.appendChild(e)}),console.log("lallalala"),this.selectArea.appendChild(a))},Ttag.prototype.getFormData=function(t){return"string"===(t=t||"string")?this.inputForm.value:this.inputForm.value.split(this.pattern)},Ttag.prototype.addTag=function(t){var e,a,i;this.isDuplicate(t)||((e=document.createElement("li")).setAttribute("class","edit-item"),(a=document.createElement("span")).setAttribute("class","edit-item-text"),a.innerHTML=t,(i=document.createElement("span")).setAttribute("class","edit-item-del"),e.appendChild(a),e.appendChild(i),this.editarea.appendChild(e),this.inputForm.value=this.inputForm.value+t+this.pattern)},Ttag.prototype.isDuplicate=function(t){for(var e=!1,a=this.inputForm.value.split(this.pattern),i=0,n=a.length;i<n;i++)if(a[i]===t){e=!0;break}return e},Ttag.prototype.hideSelTag=function(){console.log("选择框隐藏"),this.tag.show=!1},Ttag.prototype.newTag=function(){var t,e,a=this;this.editarea.querySelector(".ttag-input")||((e=document.createElement("li")).setAttribute("class","edit-item"),(t=document.createElement("input")).setAttribute("class","ttag-input"),e.appendChild(t),this.editarea.appendChild(e),(e=this.editarea.querySelector(".ttag-input")).addEventListener("blur",function(){console.log("失去焦点"),this.value&&a.addTag(this.value),this.parentNode.parentNode.removeChild(this.parentNode),console.log("焦点移除")}),e.addEventListener("keyup",function(t){13===t.keyCode&&(console.log("进入回车"),this.value&&(this.blur(),setTimeout(function(){console.log("回车重新聚焦"),a.editarea.click()})))}),e.addEventListener("click",function(t){console.log("lalla"),t.stopPropagation(),t.preventDefault()}),this.editarea.querySelector(".ttag-input").focus())};